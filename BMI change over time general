multi2<-aggregate(ChildID~weightcatr+weightcat1+IsAccountRegistered+weightcatr+weightcat1+weightcat2+weightcat3+weightcat4+weightcat5+weightcat6,FUN=sum)

length(multi$ChildID)#33012
attach(multi)
measure1<-weightcatr
measure1<-as.numeric(measure1)
measure1<-ifelse(is.na(measure1)&weightcat1>=1,paste(weightcat1),measure1)
measure1<-ifelse(is.na(measure1)&weightcat2>=1,paste(weightcat2),measure1)
measure1<-ifelse(is.na(measure1)&weightcat3>=1,paste(weightcat3),measure1)
measure1<-ifelse(is.na(measure1)&weightcat4>=1,paste(weightcat4),measure1)
measure1<-ifelse(is.na(measure1)&weightcat5>=1,paste(weightcat5),measure1)

measure2<-ifelse(!is.na(weightcatr),paste(weightcat1),NA)
measure2<-as.numeric(measure2)
measure2<-ifelse(is.na(measure2)&(!is.na(weightcatr)|!is.na(weightcat1)),paste(weightcat2),measure2)
measure2<-as.numeric(measure2)
measure2<-ifelse(is.na(measure2)&(!is.na(weightcatr)|!is.na(weightcat1)|!is.na(weightcat2)),paste(weightcat3),measure2)
measure2<-as.numeric(measure2)
measure2<-ifelse(is.na(measure2)&(!is.na(weightcatr)|!is.na(weightcat1)|!is.na(weightcat2)|!is.na(weightcat3)),paste(weightcat4),measure2)
measure2<-as.numeric(measure2)
measure2<-ifelse(is.na(measure2)& (!is.na(weightcatr)|!is.na(weightcat1)|!is.na(weightcat2)|!is.na(weightcat3)|!is.na(weightcat4))&weightcat5>=1,paste(weightcat5),measure2)
measure2<-as.numeric(measure2)
measure2<-ifelse(is.na(measure2)& (!is.na(weightcatr)|!is.na(weightcat1)|!is.na(weightcat2)|!is.na(weightcat3)|!is.na(weightcat4)|!is.na(weightcat5))&weightcat6>=1,paste(weightcat6),measure2)
measure2<-as.numeric(measure2)
multi$measure1<-measure1
multi$measure2<-measure2
#WHAT IS THE CHANGE AFTER THE SECOND MEASUREMENT?

which((multi$measure1<multi$measure2))#which children increaed weight category from rec to their next measurement


measure3<-ifelse(!is.na(measure2)&!is.na(weightcat1),paste(weightcat1),NA)
measure2<-ifelse(!is.na(measure1)&!is.na(weightcat2)
==measure1,paste(weightcat2),paste(measure2))
measure2<-ifelse(is.na(measure1)& weightcat3>=1,paste(weightcat3),paste(measure1))
measure2<-ifelse(is.na(measure1)& weightcat4>=1,paste(weightcat4),paste(measure1))
measure2<-ifelse(is.na(measure1)& weightcat5>=1,paste(weightcat5),paste(measure1))
measure2<-ifelse(is.na(measure1)& weightcat6>=1,paste(weightcat6),paste(measure1))


multiple$measure2<-ifelse(multiple$BMI1>0,multiple$weightcat1,"NA")

#Measure 2 is from year 1 in each case

multiple$measure3<-"NA"
multiple$measure3<-ifelse(multiple$BMI2>0,multiple$weightcat2,multiple$measure3)

#Measure 3 is from year 2 in each case

multiple$measure4<-"NA"
multiple$measure4<-ifelse((multiple$measure3>=1),multiple$weightcat3,NA)
multiple$measure2<-ifelse(multiple$measure3>=1&multiple$measure4=="NA"&multiple$weightcat4>0,multiple$weightcat4,multiple$measure4)
multiple$measure2<-ifelse(multiple$measure3>=1&multiple$measure4=="NA"&multiple$weightcat5>0,multiple$weightcat5,multiple$measure4)
multiple$measure2<-ifelse(multiple$measure3>=1&multiple$measure4=="NA"&multiple$weightcat6>0,multiple$weightcat6,multiple$measure4)

multiple$measure2<-ifelse(multiple$measure2=="NA"&multiple$BMI4>1,multiple$weightcat4,multiple$measure2)
multiple$measure2<-ifelse(multiple$measure2=="NA"&multiple$BMI5>1,multiple$weightcat5,multiple$measure2)
multiple$measure2<-ifelse(multiple$measure2=="NA"&multiple$BMI6>1,multiple$weightcat6,multiple$measure2)

multiple$measure2<-ifelse(&multiple$measure2=="NA"&multiple$BMI3>1&!multiple$weightcat3==multiple$measure1,multiple$weightcat3,multiple$measure2)

multiple$measure2<-ifelse(multiple$measure2=="NA"&multiple$BMI4>1&!multiple$weightcat4==multiple$measure1,multiple$weightcat4,multiple$measure2)

multiple$measure2<-ifelse(multiple$measure2=="NA"&multiple$BMI5>1&!multiple$weightcat5==multiple$measure1,multiple$weightcat5,multiple$measure2)

multiple$measure2<-ifelse(multiple$measure2=="NA"&multiple$BMI6>1&!multiple$weightcat6==multiple$measure1,multiple$weightcat6,multiple$measure2)

multiple$measure3<-ifelse(multiple$measure2>1&multiple$BMI2>1&!multiple$weightcat1==multiple$BMI2&!multiple$weightcat2==multiple$BMI2,multiple$weightcat2,multiple$measure2)
multiple$measure3<-ifelse(multiple$measure2>1&multiple$measure3=="NA"&multiple$BMI3>1&!multiple$weightcat3==multiple$measure1&!multiple$weightcat3==multiple$measure1,multiple$weightcat3,multiple$measure2)
multiple$measure3<-ifelse(multiple$measure2>1&multiple$measure3=="NA"&multiple$BMI4>1&!multiple$weightcat3==multiple$measure1&!multiple$weightcat4==multiple$measure1,multiple$weightcat4,multiple$measure2)
multiple$measure3<-ifelse(multiple$measure2>1&multiple$measure3=="NA"&multiple$BMI5>1&!multiple$weightcat3==multiple$measure1&!multiple$weightcat5==multiple$measure1,multiple$weightcat5,multiple$measure2)
multiple$measure3<-ifelse(multiple$measure2>1&multiple$measure3=="NA"&multiple$BMI6>1&!multiple$weightcat3==multiple$measure1&!multiple$weightcat6==multiple$measure1,multiple$weightcat6,multiple$measure2)
